{
  "id": "946b4bbf-7487-4982-a58d-59cac1e7bc2b",
  "title": "Missing Course/Class Metadata Issue",
  "details": "## Issue: Missing Course and Class Metadata in PDF Notes\n\n### Problem Description\nWhen running `na pdf-notes -i \"...\" --force`, the generated markdown file has empty course and class fields despite the file being placed in the correct hierarchical structure.\n\n### Root Cause Analysis\nThe issue is caused by the automatic vault root override behavior in PdfCommands.cs:\n\n1. **Vault Root Override Logic**: When no `--override-vault-root` option is provided, the system automatically sets the vault root override to the effective output directory (NotebookVaultFullpathRoot from config).\n\n2. **Path Analysis Impact**: The MetadataHierarchyDetector calculates hierarchy based on the path relative to the vault root. When the vault root is set to the same path where files are being saved, the relative path becomes empty or very short.\n\n### Example Scenario\n- Source PDF: `C:\\Users\\danshue.REDMOND\\OneDrive\\Education\\MBA-Resources\\Value Chain Management\\Operations Management\\operations-management-quality-and-supply-chain\\Case Studies\\The Ritz-Carlton Hotel Company.pdf`\n- Config vault root: `C:/Users/danshue.REDMOND/Vault/01_Projects/MBA/`\n- Output file: `C:\\Users\\danshue.REDMOND\\Vault\\01_Projects\\MBA\\Value Chain Management\\Operations Management\\operations-management-quality-and-supply-chain\\Case Studies\\The Ritz-Carlton Hotel Company.md`\n\n**Without vault root override:**\n- Relative path: `Value Chain Management/Operations Management/operations-management-quality-and-supply-chain/Case Studies/The Ritz-Carlton Hotel Company.md`\n- Hierarchy: program=\"Value Chain Management\", course=\"Operations Management\", class=\"operations-management-quality-and-supply-chain\"\n\n**With vault root override (current behavior):**\n- Vault root override: `C:/Users/danshue.REDMOND/Vault/01_Projects/MBA/`\n- Relative path: `Value Chain Management/Operations Management/operations-management-quality-and-supply-chain/Case Studies/The Ritz-Carlton Hotel Company.md`\n- This should work correctly, but there may be a bug in the path calculation\n\n### Solutions\n1. **Don't use vault root override** - Let the system use the configured vault root\n2. **Use explicit vault root override** - Specify `--override-vault-root` with the source directory\n3. **Fix the path calculation bug** - Investigate why the relative path calculation isn't working correctly\n\n### Code References\n- PdfCommands.cs lines 156-159: Vault root override logic\n- MetadataHierarchyDetector.cs: Path-based hierarchy detection\n- VaultRootContextService.cs: Vault root override service",
  "category": "troubleshooting",
  "dateCreated": "2025-06-18T01:56:49.298Z",
  "dateUpdated": "2025-06-18T01:56:49.298Z"
}