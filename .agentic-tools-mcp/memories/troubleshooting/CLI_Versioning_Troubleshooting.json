{
  "id": "4604c1d8-83ed-43fd-bb21-9bec5804edaa",
  "title": "CLI Versioning Troubleshooting",
  "details": "## CLI Versioning Issue Troubleshooting Log\n\n### Issue\nThe na.exe CLI application was reporting \"1.0.0-beta\" instead of the actual CI build version when running `na.exe --version`.\n\n### Root Cause Analysis\n1. **Primary Issue**: The CI workflow was not setting the `/p:InformationalVersion` property during the `dotnet publish` step, only during the build step.\n2. **Workflow Conflicts**: Both Python (`build-exe.yml`) and C# (`ci-windows.yml`) workflows were present, potentially causing confusion.\n3. **CI Build Failures**: Recent CI builds were failing due to formatting issues in Program.cs\n\n### Actions Taken\n1. **Fixed CI Workflow Versioning**:\n   - Added `/p:InformationalVersion=\"${{ env.BUILD_VERSION }}\"` to both build and publish steps in `.github/workflows/ci-windows.yml`\n   - Fixed multiple YAML and PowerShell formatting issues in the workflow\n\n2. **Disabled Python Workflow**:\n   - Initially renamed `build-exe.yml` to `build-exe.yml.disabled`\n   - Completely removed the disabled Python workflow file from the repository\n   - Now only C# workflow (`ci-windows.yml`) and cleanup workflow (`cleanup-artifacts.yml`) remain active\n\n3. **Fixed CI Build Failures**:\n   - Resolved formatting issues in `Program.cs`:\n     - Fixed WHITESPACE error (inline return statement)\n     - Fixed FINALNEWLINE error (missing final newline)\n   - Used `dotnet format` to ensure compliance with formatting rules\n\n4. **Script Updates**:\n   - Updated `download-latest-artifact.ps1` to use relative paths and copy full config directory\n\n### Technical Details\n- **Version Properties**: The CLI uses `Assembly.GetExecutingAssembly().GetCustomAttribute<AssemblyInformationalVersionAttribute>()?.InformationalVersion` to get version info\n- **Build Properties**: InformationalVersion needs to be set during publish, not just build, for the final executable to contain the correct version\n- **Workflow Structure**: Only the C# workflow should be active to avoid conflicts\n- **Formatting Issues**: CI builds were failing on `dotnet format --verify-no-changes --severity error` due to whitespace and newline issues\n\n### Current Status\n- Python workflow completely removed ✅\n- C# workflow updated with proper versioning ✅\n- Formatting issues in Program.cs resolved ✅\n- New CI build triggered with all fixes applied ✅\n- Need to wait for CI build completion and test version reporting\n\n### Next Steps\n- Wait for CI build to complete successfully\n- Download latest CI artifact and test version reporting\n- Confirm CLI shows actual build version instead of \"1.0.0-beta\"",
  "category": "troubleshooting",
  "dateCreated": "2025-06-11T19:57:00.903Z",
  "dateUpdated": "2025-06-11T20:31:25.500Z"
}