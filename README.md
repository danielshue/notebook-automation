# Notebook Automation Tool

A comprehensive toolkit for managing course notes and resources in an Obsidian vault. The suite of scripts automates the process of converting course materials, generating index files, and organizing content for easy navigation and retrieval. It also supports advanced workflows for PDF and video reference note generation with OneDrive integration and AI-powered summaries.

## New Package Structure

The project has been reorganized into a proper Python package structure for better maintainability and ease of use. This new structure provides several benefits:

- Reliable imports between modules
- Easier installation and distribution
- Command-line entry points for common tasks
- Better organization and modularity
- Type hints and improved documentation

### Package Organization

```
notebook_automation/
├── __init__.py              # Package metadata and version info
├── configure.py             # Configuration management
├── tools/                   # Core functionality modules
│   ├── utils/               # Utility functions
│   ├── pdf/                 # PDF processing tools
│   ├── auth/                # Authentication modules
│   ├── ai/                  # AI integration modules
│   └── ...
├── tags/                    # Tag management scripts
├── obsidian/                # Obsidian-specific tools
├── video/                   # Video processing tools
└── utilities/               # General helper scripts
```


### Getting Started

```pwsh
# Install in development mode
pip install -e .

# Run CLI tools using entry points (recommended)
notebook-add-nested-tags --help
notebook-clean-index-tags --help
notebook-consolidate-tags --help
notebook-generate-tag-doc --help
notebook-restructure-tags --help
notebook-tag-manager --help

# Example: Add nested tags with verbose output
notebook-add-nested-tags . --dry-run --verbose

# Example: Clean tags from index files
notebook-clean-index-tags . --verbose

# Example: Consolidate tags in all notes
notebook-consolidate-tags . --verbose

# Example: Generate tag documentation
notebook-generate-tag-doc --help

# All CLI tools support --help and --verbose for colorized, detailed output.
```

### Configuration

Configuration files are now stored in `~/.notebook_automation/config.json` by default, making it easier to work with the package when installed system-wide.


## CLI Tools Overview

The toolkit provides the following CLI entry points (available after installation):

| Command                       | Purpose                                                      |
|-------------------------------|--------------------------------------------------------------|
| notebook-add-nested-tags      | Add nested tags to notes based on YAML frontmatter           |
| notebook-clean-index-tags     | Remove all tags from index files                             |
| notebook-consolidate-tags     | Consolidate/sort tags in notes, remove duplicates            |
| notebook-generate-tag-doc     | Generate tag usage and hierarchy documentation               |
| notebook-restructure-tags     | Restructure tags for consistency (e.g., lowercase, dashes)   |
| notebook-tag-manager          | Advanced tag management, refactoring, and analysis           |

All tools support `--help` for usage and `--verbose` for colorized, detailed output.

Legacy scripts (e.g., `generate_pdf_notes_from_onedrive.py`, `generate_video_meta_from_onedrive.py`, etc.) are still available for advanced workflows, but most tag and note management should use the CLI entry points above.

## Workspace Organization

The repository is organized as follows:

- **Main Directory**: Contains the primary, actively used scripts (see [Primary Scripts](#primary-scripts) section above)
- **`/docs`**: Contains all documentation files and READMEs
- **`/tags`**: Contains tag management and generation scripts
- **`/tests`**: Contains all test scripts for the codebase
- **`/debug`**: Contains debugging and troubleshooting scripts
- **`/archived`**: Contains older versions and redundant scripts
- **`/tools`**: Core package with modular functionality used by scripts
- **`/utilities`**: Contains utility scripts and helper tools
- **`/obsidian`**: Contains Obsidian-specific tools and utilities
- **`/video`**: Contains video processing scripts
- **`/data`**: Contains data files and script results
- **`/cache`**: Contains authentication tokens and cache files
- **`/logs`**: Contains log files generated by the scripts

For a comprehensive overview of the workspace organization, including detailed listings of primary vs. supporting scripts, see [Final Organization](docs/final_organization.md).

For a list of planned tasks, improvements, and future enhancements, see the [Project Backlog](docs/project_backlog.md).

For detailed documentation on individual features, please see the files in the [docs](docs/) directory.

## Features

### File Conversion
- Converts HTML files to Markdown with proper formatting
- Converts transcript TXT files to Markdown
- Cleans up filenames by removing numbering prefixes and improving readability
- Adds YAML frontmatter with template type and auto-generated state properties
- Automatically adds appropriate titles to all generated files
- Before creating a file, the tool checks if it already exists in the target directory. If it does, the file will only be overwritten if the `--force` flag is set; otherwise, it will be skipped and a message will be shown.

### Index Generation
- Creates a hierarchical structure of index files for easy navigation
- Supports a 6-level hierarchy: Main → Program → Course → Class → Module → Lesson
- Generates Obsidian-compatible wiki-links between index levels
- Creates back-navigation links for seamless browsing (with correct filenames)
- Respects "readonly" marked files to prevent overwriting customized content

### PDF & Video Reference Note Generation
- Scans PDFs and videos from OneDrive MBA-Resources folder
- Authenticates with Microsoft Graph API for secure access to OneDrive
- Creates shareable links for PDFs and videos stored in OneDrive
- Generates markdown notes in the Obsidian vault with both local file:// links and shareable OneDrive links
- Extracts text from PDFs and transcripts, generating AI-powered summaries and tags (OpenAI integration)
- Infers course and program information from file paths
- Maintains consistent folder structure between OneDrive and Obsidian vault
- Robust error handling, retry mechanism, and secure token management
- Preserves user modifications to notes (respects auto-generated-state flag)
- Supports dry-run, retry, and force-overwrite modes

### Content Organization
- Automatically categorizes content into readings, videos, transcripts, etc.
- Adds appropriate icons for different content types
- Implements an advanced nested tagging system for enhanced content discovery
- Supports program, course, term, content type, and workflow tags

### Nested Tag System
- Hierarchical tag structure with forward slashes for nesting (e.g., `type/note/lecture`)
- Automatically detects and applies course codes, terms, and subject areas
- Includes program information (`program/imba`), course codes (`course/FIN501`), and terms (`term/2024-spring`)
- Organizes by content type, subject area, skills, tools, status, and priority
- Fully supports Obsidian's tag pane and Dataview plugin

## Directory Structure

The tool expects and generates the following directory structure:
```
- Root (main-index)
  - Program Folders (program-index)
    - Course Folders (course-index)
      - Class Folders (class-index)
        - Case Study Folders (case-study-index)
        - Module Folders (module-index)
          - Live Session Folder (live-session-index)
          - Lesson Folders (lesson-index)
            - Content Files (readings, videos, transcripts, etc.)
```

## Installation

1. Clone this repository:
```
git clone https://github.com/danielshue/notebook-automation.git
```

2. Install the required dependencies:
```
pip install pyyaml html2text requests msal openai python-dotenv cryptography urllib3
```


## Usage

After installation, use the CLI entry points for all tag and note management tasks. For example:

```pwsh
# Add nested tags to all notes in the current directory (dry run, verbose)
notebook-add-nested-tags . --dry-run --verbose

# Clean tags from all index files in a directory
notebook-clean-index-tags ./notes --verbose

# Consolidate tags in all notes
notebook-consolidate-tags ./notes --verbose

# Generate tag documentation
notebook-generate-tag-doc --help
```

For PDF and video processing, you may still use the legacy scripts directly:

```pwsh
python generate_pdf_notes_from_onedrive.py --folder <folder> [--force] [--dry-run]
python generate_video_meta_from_onedrive.py --folder <folder> [--force] [--dry-run]
```

## Examples

Convert HTML/TXT files and generate indexes for a specific course:
```
python generate_markdown_from_html_and_text_in_vault.py --all --source /path/to/accounting-for-managers
```

Generate PDF notes for all files in a OneDrive folder:
```
python generate_pdf_notes_from_onedrive.py --folder "Value Chain Management/Managerial Accounting Business Decisions/Case Studies" --force
```

Generate video notes for a single video file:
```
python generate_video_meta_from_onedrive.py -f "Value Chain Management/Managerial Accounting Business Decisions/Module 1/Video1.mp4" --force
```

## Templater Integration

The tool includes Templater templates for Obsidian that can be used to create standardized notes:

- **Lesson Note**: Template for creating structured lesson notes with sections for summary, key points, questions, and action items.


## CLI Arguments

All CLI tools support `--help` for full argument details. Common options include:

- `--verbose` : Enable colorized, detailed output (per-file progress, summary)
- `--dry-run` : Show what would be changed, but do not modify files
- `--folder`  : Specify a folder to process (for PDF/video tools)
- `--force`   : Overwrite existing files/notes

See each tool's `--help` for more options.

## Requirements

- Python 3.6+
- pyyaml, html2text, requests, msal, openai, python-dotenv, cryptography, urllib3
- Obsidian (for viewing and working with the generated files)

## License

MIT

## Author

Daniel Shue
